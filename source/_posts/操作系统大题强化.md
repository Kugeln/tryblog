---
title: 操作系统大题强化
date: 2025-06-12 17:50:46
tags: 408日常
sticky: 269
banner_img: /img/1920x1080 (40).jpg
index_img: /img/1920x1080 (40).jpg
---

## PV操作大题总结

![](/img/WREC.png)

### PV操作常见的考法

![](/img/jmhtgbrsfvadcs.png)

* 生产者消费者问题
  * 一类进程负责生产资源，另一类进程负责消费资源
* 理发师问题：
  * 一类进程负责生产服务，另一类资源负责消费服务
* 读者写者问题：
  * 同类不互斥，异类互斥
* 哲学家进餐问题：
  * 只有一类进程，每个进程需要同时拥有多种资源才能运行
  * 核心问题是解决思索，如何让每个进程持有多种资源去运行，同时还不造成这种循环等待的死锁
* 单纯的同步问题：
  * 前驱后继图

### 生产者—消费者问题

![](/img/grefasdf.png)

![](/img/yhstrae.png)

* 进程→动作→PV同步→PV互斥缓冲区→信号量→死锁
* 1、分析有几类进程
  * 每类进程对应一个函数
  * 具体有几类进程得看这些进程需要做的动作完全一致，就属于同一进程，如果要做的动作不完全一致，那就属于不同类的进程
* 2、在每个函数内部分析，用中文描述各类进程的动作是什么
  * 动作有两种：
    * 只做一次？
      * 不加while
    * 不断重复？
      * 加while（1）
* 3、依次分析每一类动作之前，是否需要P什么？
  * 先确定P操作，在哪些地方需要P一个资源
    * 这些动作需不需要等待某一事情的发生才能进行，那么在这种动作之前，需要P一种资源（有没有可能因为什么资源不到位而导致这个动作被阻塞）
      * 不需要等待某件事情的发生就能够进行，那么在该动作之前不需要P操作
  * 再想办法去思考这个V操作，只要有P必有V，每写一个P，就要安排V，这个V操作应该安排在什么位置
    * 也就是前面P操作申请的某种资源在哪里会得到释放，在对应的动作后面加入V操作
  * 注意隐含的互斥（eg：缓冲区访问需要加P（mutex））
    * 缓冲区需要互斥访问，p1写的时候p2不能读
    * 访问前p（mutex）访问后v（mutex），保证对缓冲区的互斥访问
    * 如果需要把产品放到某个地方或者说某个缓冲区（所有用于存放零件存放产品的这些东西，都把他视为所谓的缓冲区），那么就需要加P（mutex）和V（mutex）
      * 互斥信号量的初始值=1
* 4、所有PV写完后，再去定义信号量，定义完再思考每个信号量的初值是多少？
* 5、检查多个P连续出现的地方，是否可能产生死锁？
  * 可以尝试调整P顺序，若某信号量P、V操作总时连续出现，中间没有夹其他P，则不可能因此产生死锁
  * 同步问题和互斥问题同时出现的时候，要确保互斥锁P的操作在同步的P操作的后面，同步操作把互斥操作包含在内
  * 死锁产生的条件：请求和保持
    * 手里面持有资源的同时在等待新的资源
    * 一般来说缓冲区的互斥访问PV里面没有夹杂其他PV操作，所以一般来说互斥访问缓冲区的PV操作不会产生死锁
* 6、读题检查，是否满足题目要求

#### 习题带练

##### 1

![](/img/thsagrfd.png)

![](/img/rstfvds.png)

##### 2

![](/img/gaerds.png)

![](/img/aergds.png)

##### 3

![](/img/iutyjthrsge.png)

![](/img/htrsfsd.png)

### 哲学家问题

![](/img/dhgsfdss.png)

* 1、限制申请资源的顺序（解法一不通用，不建议使用）
  * 如：规定单号哲学家先取左筷子，双号先取右筷子
    * 破坏了请求和保持这个条件
* 2、限制并发进程数量（解法二通用，但并发度不高，不建议使用）
  * 如：规定同一时间只能有一个哲学家就餐（禁止并行）
* 3、让进程一口气取得所有资源，再开始运行（通用，且并发度高，建议使用）
  * 如：哲学家只有能够取得两个筷子时才会就餐

* 一类进程需要同时持有多种资源才能正常往下运行
* 哲学家问题大概率出现防止死锁的题眼

![](/img/iuynhtbgrvfd.png)

* 用int型变量定义各类资源，在每一个进程开始做事之前，一口气把所有的资源都拿到手，然后再开始做他该做的事情，做完这些事情之后，再一口气归还所有的资源。
  * 这样可以确保死锁不发生，也可以确保进程和进程之间的并发度

#### 习题带练

##### 1

![](/img/tsrfdg.png)

![](/img/220654.jpg)

##### 2

### 单纯的同步问题

* 前V后P，每一对前驱后继关系中间定义一个信号量（暴力）

![](/img/jsrthargd.png)

#### 习题带练

##### 1

![](/img/uythrgeafw.png)

![](/img/214750.jpg)

##### 2

![](/img/thrrdsa.png)

![](/img/215009.jpg)